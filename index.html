<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>GEO-RELIC: OMNI-TITAN ENGINE</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;900&family=JetBrains+Mono:wght@300;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --neon-primary: #00ff88; --neon-danger: #ff0055; --neon-info: #00d9ff;
            --gold: #ffcc00; --deep-bg: #020205; --panel-bg: #0a0a0f;
            --glass: rgba(255, 255, 255, 0.03);
        }

        * { box-sizing: border-box; outline: none; -webkit-tap-highlight-color: transparent; }
        body { 
            background: #000; color: #e0e0e0; font-family: 'JetBrains Mono', monospace;
            margin: 0; display: flex; justify-content: center; align-items: center; 
            height: 100vh; overflow: hidden;
        }

        /* HARDWARE CASING */
        #mobile-chassis {
            width: 430px; height: 900px; background: var(--deep-bg);
            border: 8px solid #1a1a2e; border-radius: 60px; position: relative;
            display: flex; flex-direction: column; overflow: hidden;
            box-shadow: 0 0 80px rgba(0, 255, 136, 0.1);
        }

        /* TOP STATUS BAR */
        .status-bar { height: 140px; padding: 45px 30px 10px; display: grid; grid-template-columns: 1fr 1fr; gap: 15px; background: linear-gradient(to bottom, #000, transparent); z-index: 100; }
        .data-pill { background: var(--panel-bg); border: 1px solid #222; padding: 10px; border-radius: 12px; position: relative; overflow: hidden; }
        .label { font-size: 9px; text-transform: uppercase; color: #555; font-weight: 900; }
        .value { font-family: 'Orbitron'; font-size: 14px; color: var(--neon-primary); }
        .progress-fill { position: absolute; bottom: 0; left: 0; height: 3px; background: var(--neon-primary); transition: 0.5s; }

        /* THE WORLD MAP SYSTEM */
        #map-viewport { flex-grow: 1; position: relative; background: #050508; overflow: hidden; }
        #world-grid { 
            position: absolute; width: 1000px; height: 1000px; 
            background-image: radial-gradient(#1a1a2e 1px, transparent 1px);
            background-size: 40px 40px; transition: 0.2s ease-out;
        }
        .node { 
            position: absolute; width: 50px; height: 50px; background: var(--glass); 
            border: 2px solid var(--neon-info); border-radius: 50%; display: grid; 
            place-items: center; font-size: 20px; cursor: pointer; box-shadow: 0 0 15px rgba(0, 217, 255, 0.2);
        }
        .node.completed { border-color: #444; color: #444; }
        #player-token { 
            position: absolute; width: 30px; height: 30px; background: var(--neon-primary); 
            border-radius: 5px; z-index: 50; transition: 0.3s; box-shadow: 0 0 20px var(--neon-primary);
        }

        /* FIDGET DASHBOARD */
        #fidget-deck { position: absolute; bottom: 100px; left: 0; width: 100%; height: 80px; background: rgba(0,0,0,0.8); display: flex; align-items: center; justify-content: space-around; padding: 0 20px; border-top: 1px solid #222; }
        .fidget-spinner-ui { width: 50px; height: 50px; background: #111; border-radius: 50%; border: 2px dashed var(--neon-primary); animation: spin 2s linear infinite; cursor: pointer; }
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        .fidget-toggle { width: 60px; height: 30px; background: #333; border-radius: 20px; position: relative; cursor: pointer; }
        .fidget-toggle::after { content: ''; position: absolute; width: 26px; height: 26px; background: #fff; border-radius: 50%; top: 2px; left: 2px; transition: 0.2s; }
        .fidget-toggle.on::after { left: 32px; background: var(--neon-primary); }

        /* MODAL OVERLAYS */
        .ui-screen { position: absolute; inset: 0; background: rgba(0,0,0,0.95); z-index: 500; display: none; padding: 60px 30px; flex-direction: column; }
        .btn-action { background: #111; border: 1px solid #333; color: #fff; padding: 20px; border-radius: 15px; margin-bottom: 10px; font-family: 'Orbitron'; cursor: pointer; text-align: left; }
        .btn-action:hover { border-color: var(--neon-primary); }

        /* QUIZ ENGINE */
        #quiz-overlay { z-index: 600; background: var(--deep-bg); }
        .choice-container { display: grid; gap: 10px; margin-top: 40px; }
        .choice-btn { background: #0f172a; border: 1px solid #1e293b; color: #fff; padding: 25px; border-radius: 20px; font-size: 16px; font-weight: bold; cursor: pointer; transition: 0.2s; }
        .choice-btn:active { transform: scale(0.98); }

        /* NAVIGATION BAR */
        .bottom-tabs { height: 90px; background: #000; display: grid; grid-template-columns: repeat(4, 1fr); border-top: 1px solid #222; }
        .tab { display: flex; flex-direction: column; align-items: center; justify-content: center; color: #444; font-size: 10px; cursor: pointer; font-weight: 900; }
        .tab.active { color: var(--neon-primary); }

        /* WEATHER EFFECTS */
        #weather-layer { position: absolute; inset: 0; pointer-events: none; z-index: 200; opacity: 0; transition: 1s; }
        .storm { background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(2px); }
    </style>
</head>
<body>

<div id="mobile-chassis">
    <div id="weather-layer"></div>

    <div class="status-bar">
        <div class="data-pill">
            <div class="label">Integrity</div>
            <div class="value" id="hp-val">100%</div>
            <div class="progress-fill" id="hp-bar" style="width: 100%;"></div>
        </div>
        <div class="data-pill">
            <div class="label">Credits</div>
            <div class="value" id="gold-val" style="color:var(--gold)">0</div>
        </div>
    </div>

    <div id="map-viewport">
        <div id="world-grid">
            <div id="player-token"></div>
            </div>
    </div>

    <div id="fidget-deck">
        <div class="fidget-spinner-ui" onclick="fidgetClick(25)"></div>
        <div class="fidget-toggle" id="f-toggle" onclick="fidgetToggle()"></div>
        <div style="width:80px; height:10px; background:#222; border-radius:5px;"><div id="f-slide" style="width:0%; height:100%; background:var(--neon-info)"></div></div>
    </div>

    <div id="vault-screen" class="ui-screen">
        <h1 style="font-family:'Orbitron'; color:var(--neon-info)">THE ARCHIVE</h1>
        <div id="relic-list" style="overflow-y:auto"></div>
        <button class="btn-action" onclick="closeScreens()" style="margin-top:auto; text-align:center">CLOSE</button>
    </div>

    <div id="quiz-overlay" class="ui-screen">
        <div id="quiz-content"></div>
    </div>

    <div id="shop-screen" class="ui-screen">
        <h1 style="font-family:'Orbitron'; color:var(--gold)">BLACK MARKET</h1>
        <div class="btn-action" onclick="buy('nanite', 5000)">Repulsor Nanites (Shield) - 5,000G</div>
        <div class="btn-action" onclick="buy('sat', 15000)">Satellite Link (Skip) - 15,000G</div>
        <div class="btn-action" onclick="buy('core', 50000)">Omni-Core (Legendary) - 50,000G</div>
        <button class="btn-action" onclick="closeScreens()" style="margin-top:auto; text-align:center">CLOSE</button>
    </div>

    <div class="bottom-tabs">
        <div class="tab active" onclick="closeScreens()">MAP</div>
        <div class="tab" onclick="openScreen('vault-screen')">VAULT</div>
        <div class="tab" onclick="openScreen('shop-screen')">MARKET</div>
        <div class="tab" id="weather-indicator">CLEAR</div>
    </div>
</div>

<script>
    /**
     * GEOGRAPHY ENGINE DATA
     */
    const GEO_DB = [
        { q: "Which country has the most time zones?", a: "France", o: ["USA", "Russia", "France", "China"], lat: 200, lng: 300 },
        { q: "What is the largest country by area in Africa?", a: "Algeria", o: ["Nigeria", "Algeria", "Sudan", "Congo"], lat: 400, lng: 500 },
        { q: "Mount Vesuvius overlooks which modern city?", a: "Naples", o: ["Rome", "Naples", "Florence", "Palermo"], lat: 150, lng: 450 },
        { q: "Which desert covers much of Mongolia?", a: "Gobi", o: ["Sahara", "Gobi", "Thar", "Atacama"], lat: 300, lng: 700 },
        { q: "What is the world's northernmost capital city?", a: "Reykjavik", o: ["Oslo", "Reykjavik", "Helsinki", "Ottawa"], lat: 50, lng: 200 },
        { q: "In which ocean is the island of Madagascar?", a: "Indian Ocean", o: ["Atlantic", "Pacific", "Indian Ocean", "Southern"], lat: 650, lng: 600 },
        { q: "The Mekong River flows into which sea?", a: "South China Sea", o: ["Sea of Japan", "South China Sea", "Andaman Sea", "Red Sea"], lat: 500, lng: 800 },
        { q: "Which South American country is landlocked?", a: "Bolivia", o: ["Chile", "Bolivia", "Peru", "Guyana"], lat: 700, lng: 350 }
    ];

    /**
     * GAME STATE ENGINE
     */
    const GameState = {
        hp: 100, gold: 0, 
        currentPos: { x: 50, y: 50 },
        discovered: [],
        inventory: [],
        activeNode: null,
        weather: 'CLEAR'
    };

    /**
     * INITIALIZATION
     */
    function init() {
        const grid = document.getElementById('world-grid');
        GEO_DB.forEach((node, index) => {
            const div = document.createElement('div');
            div.className = 'node';
            div.style.left = node.lng + 'px';
            div.style.top = node.lat + 'px';
            div.innerHTML = 'üìç';
            div.onclick = () => movePlayer(node, index);
            grid.appendChild(div);
        });
        updateHUD();
        weatherCycle();
    }

    /**
     * NAVIGATION ENGINE
     */
    function movePlayer(node, index) {
        if(GameState.discovered.includes(index)) return;
        
        const token = document.getElementById('player-token');
        token.style.left = (node.lng + 10) + 'px';
        token.style.top = (node.lat + 10) + 'px';
        
        GameState.activeNode = { ...node, id: index };
        setTimeout(() => startQuiz(node), 400);
    }

    /**
     * QUIZ CONTROLLER
     */
    function startQuiz(data) {
        const overlay = document.getElementById('quiz-overlay');
        const content = document.getElementById('quiz-content');
        overlay.style.display = 'flex';
        
        let shuffled = [...data.o].sort(() => Math.random() - 0.5);
        
        content.innerHTML = `
            <div style="font-size:12px; color:var(--neon-info); margin-bottom:10px;">ENCOUNTER: ${GameState.weather} CONDITIONS</div>
            <h2 style="font-family:'Orbitron'; line-height:1.4;">${data.q}</h2>
            <div class="choice-container">
                ${shuffled.map(o => `<button class="choice-btn" onclick="handleChoice('${o}')">${o}</button>`).join('')}
            </div>
        `;

        if(GameState.weather === 'STORM') {
            content.style.filter = 'blur(4px)';
            setTimeout(() => content.style.filter = 'blur(0)', 1000);
        }
    }

    function handleChoice(val) {
        const correct = val === GameState.activeNode.a;
        if(correct) {
            GameState.gold += 1500;
            GameState.discovered.push(GameState.activeNode.id);
            alert("‚úÖ RELIC SECURED (+1500G)");
        } else {
            GameState.hp -= 20;
            alert("‚ùå INTEGRITY BREACHED (-20%)");
        }
        
        updateHUD();
        closeScreens();
        
        if(GameState.hp <= 0) {
            alert("CRITICAL FAILURE: Memory Wipe Initialized.");
            location.reload();
        }
    }

    /**
     * FIDGET LOGIC
     */
    function fidgetClick(amt) {
        GameState.gold += 10;
        updateHUD();
        // Shake animation
        const s = document.querySelector('.fidget-spinner-ui');
        s.style.borderColor = "var(--neon-danger)";
        setTimeout(() => s.style.borderColor = "var(--neon-primary)", 100);
    }

    function fidgetToggle() {
        const t = document.getElementById('f-toggle');
        t.classList.toggle('on');
        GameState.gold += 50;
        updateHUD();
    }

    /**
     * WEATHER ENGINE
     */
    function weatherCycle() {
        const layer = document.getElementById('weather-layer');
        const ind = document.getElementById('weather-indicator');
        const r = Math.random();
        
        if(r > 0.7) {
            GameState.weather = 'STORM';
            layer.style.opacity = '1';
            layer.classList.add('storm');
            ind.style.color = 'var(--neon-danger)';
            ind.innerText = 'STORM';
        } else {
            GameState.weather = 'CLEAR';
            layer.style.opacity = '0';
            ind.style.color = '#444';
            ind.innerText = 'CLEAR';
        }
        setTimeout(weatherCycle, 10000);
    }

    /**
     * UI HELPERS
     */
    function updateHUD() {
        document.getElementById('hp-val').innerText = GameState.hp + "%";
        document.getElementById('hp-bar').style.width = GameState.hp + "%";
        document.getElementById('gold-val').innerText = GameState.gold.toLocaleString();
    }

    function openScreen(id) {
        document.querySelectorAll('.ui-screen').forEach(s => s.style.display = 'none');
        document.getElementById(id).style.display = 'flex';
    }

    function closeScreens() {
        document.querySelectorAll('.ui-screen').forEach(s => s.style.display = 'none');
    }

    function buy(item, price) {
        if(GameState.gold >= price) {
            GameState.gold -= price;
            GameState.inventory.push(item);
            updateHUD();
            alert("Acquired: " + item);
        } else {
            alert("Insufficient Credits.");
        }
    }

    // Initialize Game
    init();

</script>
</body>
</html>
